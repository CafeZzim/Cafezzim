<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cafe.gitteam1.reserve.ReserveMapper">
	<insert id="reserveResult" parameterType="com.cafe.gitteam1.reserve.ReserveVo">
		insert into reserve_info(
		cafe_id, member_id, isCancelled, reserve_date, reserve_time, 
		reserve_name, reserve_phone, reserve_4seats, reserve_2seats, request, 
		payment_price, payment_method, payment_date) 
		 values( #{cafe_id}, #{member_id}, 0, #{reserve_date}, #{reserve_time}, 
		 #{reserve_name}, #{reserve_phone}, 1, 0, #{request}, 
		 #{payment_price}, 'card', #{reserve_date} )
	</insert>

	<select id="orderMenu" resultType="com.cafe.gitteam1.search.MenuVo">
		SELECT menu_name as name, menu_price as price, menu_type as type
		FROM menu
		where cafe_id=#{cid}
	</select>
	
	<select id="viewCafe" resultType="com.cafe.gitteam1.search.CafeInfoVo">
	SELECT C.cafe_id as cid,
	cafe_name as name,
	cafe_address as address,
	title_photo AS thumb,
	lat,
	lng,
	ROUND( AVG(R.review_score),1 ) AS rating
	FROM cafe_info C
	left join review R
	on C.cafe_id = R.cafe_id
	Group by C.cafe_id
	HAVING C.cafe_id=#{cid};
	</select>
		 <!-- // 예약 확인하는 코드  -->
		<!--  SELECT * FROM `gitteam1`.`schedule`;
		select re.reserve_id, n.menu_name, re.amt, n.menu_price
		from reserve_menu re inner join menu n
		on re.menu_id = n.menu_id
		where re.reserve_id=1 ;  -->
</mapper>
